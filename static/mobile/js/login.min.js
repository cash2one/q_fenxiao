ht.login={init:function(){this.bindEvent()},popUp:function(n){var t=$("#popUp");t.find(".box").html(n),t.show(),setTimeout(function(){$("#popUp").hide()},1e3)},validate:{chkPhone:function(n){var t=ht.login,o=!0;return""==$.trim(n.val())?(t.popUp("请填写电话号码"),o=!1):/^1\d{10}$/.test(n.val())||(t.popUp("手机号码格式不正确"),o=!1),o}},getNext:function(){var n=ht.core.getQuery("next"),t="";return t=window.location.href.indexOf("/app/")>-1?"/app/index.html":n?n:"/"},bindEvent:function(){var n=this,t=$("#username"),o=$("#namedel"),i=$("#password");$("#username").on("keyup",function(){""!=$(this).val()&&o.show()}),o.on("click",function(){t.val(""),$(this).hide()});var e=$("#smsphone"),a=$("#phonedel");e.on("keyup",function(){""!=$(this).val()&&a.show()}),a.on("click",function(){e.val(""),$(this).hide()}),$("#submit").on("click",function(){var o=ht.login.validate.chkPhone(t);if(!o)return!1;if(""==i.val())return n.popUp("请填写密码"),!1;if(""!=$.trim(t.val())&&""!=i.val()){var e={login_type:"usename",usename:t.val(),password:i.val(),_xsrf:$("input[name=_xsrf]").val()};$.post("/login.html",e,function(t){var t=JSON.parse(t);return 200!=t.state?(n.popUp("密码不正确"),!1):void(window.location.href=ht.login.getNext())})}}),$("#switchSms").on("click",function(){"短信快捷登录"==$(this).html()?($(this).html("手机号码登录"),$("#smsloginform").show(),$("#loginform").hide()):($(this).html("短信快捷登录"),$("#smsloginform").hide(),$("#loginform").show())}),$("#getKeyWord").on("click",function(){var n=$("#smsphone"),t=ht.login.validate.chkPhone(n);if(!t)return!1;if($(this).hasClass("btn_enabled"))return!1;var o={phone:n.val()},i=60,e=$(this);e.html("重新获取("+i+")").attr("v",i).addClass("btn_enabled"),$.get("/common/phone/code/",o,function(){ht.core.setCountDown(e,"获取动态密码")})}),$("#smsSubmit").click(function(){var t=$("#smsphone"),o=$("#smskeyword"),i=ht.login.validate.chkPhone(t),e=""!=o.val()?!0:!1;if(!e&&n.popUp("请输入动态密码"),i&&e){var a={login_type:"phone",phone:t.val(),code:o.val(),_xsrf:$("input[name=_xsrf]").val()};$.post("/login.html",a,function(t){var t=JSON.parse(t);return 200!=t.state?(n.popUp(t.info),!1):void(window.location.href=ht.login.getNext())})}})}},$(function(){ht.login.init()});