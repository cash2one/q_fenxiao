!function(){ht.regist={init:function(){this.bindEvent()},popUp:function(e){var t=$("#popUp");t.find(".box").html(e),t.show(),setTimeout(function(){$("#popUp").hide()},1e3)},setCountDown:function(e,t){var n=parseInt(e.attr("v"),10),o=n-1;if(o>0){e.html("重新获取("+o+")").attr("v",o).addClass("btn_enabled");var a=setTimeout(function(){ht.login.setCountDown(e,t)},1e3)}else clearTimeout(a),e.html(t).removeClass("btn_enabled")},validate:{chkPhone:function(){var e=ht.regist,t=!1,n=$("#phone");return""==n.val()?e.popUp("请输入手机号码"):/^1\d{10}$/.test(n.val())?t=!0:e.popUp("手机号码格式不正确"),t},chkKapkey:function(){var e=ht.regist,t=!1,n=$("#kapkey");return""==n.val()?e.popUp("请输入验证码"):5!=n.val().length?e.popUp("验证码错误"):t=!0,t},chkSmsCode:function(){var e=ht.regist,t=!1,n=$("#smskey");return""==n.val()?e.popUp("请输入短信验证码"):4!=n.val().length?e.popUp("短信验证码错误"):t=!0,t},chkPassword:function(e){var t=ht.regist,n=!1;return e.val().length<6||e.val().length>18?t.popUp("请输入6-18位字符"):n=!0,n}},bindEvent:function(){var e=this;$("#imgKey").click(function(){$(this)[0].src="/common/image_code/?"+Math.random()});var t=$("#agree"),n=$("#acceptError");$("#rememberField .mzchkbox").click(function(){t[0].checked?(t[0].checked=!1,$(this).removeClass("weui_icon_checked").addClass("weui_icon_check"),n.show()):(t[0].checked=!0,$(this).removeClass("weui_icon_check").addClass("weui_icon_checked"),n.hide())});var o=$("#phone"),a=$("#namedel"),i=$("#kapkey");o.on("keyup",function(){""!=$(this).val()&&a.show()}),a.on("click",function(){o.val(""),$(this).hide()});var i=$("#kapkey");$("#submit").on("click",function(){var n=e.validate.chkPhone(),a=e.validate.chkKapkey();if(!t[0].checked)return!1;if(n&&a){var s=$("input[name=_xsrf]").val(),r={phone:o.val(),code:i.val(),_xsrf:s};$.post("/reg.html",r,function(t){var t=JSON.parse(t);if(200!=t.state)return e.popUp(t.info),!1;$("#step2_txt").html(t.info),$(".step1").hide(),$(".step2").show();var n=60;$("#getKey").html("重新获取("+n+")").attr("v",n).addClass("btn_enabled"),ht.core.setCountDown($("#getKey"),"获取验证码")})}}),$("#next").click(function(){var t=e.validate.chkSmsCode();if(t){var n={phone:o.val(),phonecode:$("#smskey").val()};$.get("/reg.html",n,function(t){var t=JSON.parse(t);return 200!=t.state?(e.popUp(t.info),!1):($(".step2").hide(),void $(".step3").show())})}}),$("#getKey").click(function(){if($(this).hasClass("btn_enabled"))return!1;var e={phone:o.val()};$.get("/common/phone/code/",e,function(){var e=60;$("#getKey").html("重新获取("+e+")").attr("v",e).addClass("btn_enabled"),ht.core.setCountDown($("#getKey"),"获取验证码")})}),$("#regSubmit").click(function(){var t=e.validate.chkPassword($("#password1")),n=e.validate.chkPassword($("#password2"));if(t&&n)if($("#password1").val()!=$("#password2").val())e.popUp("两次密码输入不一致");else{var a=$("input[name=_xsrf]").val(),i={phone:o.val(),pwd:$("#password1").val(),smskey:$("#smskey").val(),option:"reg",_xsrf:a};$.post("/reg.html",i,function(t){var t=JSON.parse(t);return 200!=t.state?(e.popUp(t.info),!1):void(window.location="/")})}})}}}(),$(function(){ht.regist.init()});