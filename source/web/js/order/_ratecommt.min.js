(function( window, undefined ) {
    ht.commt={
        init:function(){
            this.rate.init();
            this.valid.init();
        },
        rate:{
            init:function(){
                var _this=this;
                var flag=999;
                $('#stars1 a').click(function(){
                    var index=$(this).parent().index();
                    var i=index+1;
                    flag=index;
                    $('#stars1 a').removeClass('current-rating');
                    $(this).addClass('current-rating');
                    $('#stars1-tips').html(_this.tips[index]);
                    $('#rate').val(i);
                }).mouseover(function(){
                    if(flag<999){
                        $('#stars1 a').eq(flag).removeClass('current-rating');
                    }

                }).mouseout(function(){
                    if(flag<999){
                        $('#stars1 a').eq(flag).addClass('current-rating');
                    }

                });

            },
            tips:['差评','较差','一般','满意','非常满意']
        },
        valid:{
            init:function(){
                datatype=ht.util.validformParam.datatype;
                datatype.isRate=function(){
                    if($('#rate').val()==0){
                        return false;
                    }
                    return true;
                }
                $("#commtform").Validform({//所有可传入的参数如下：;
                    btnSubmit:"#btnCommt",
                    btnReset:"",
                    tiptype:3,
                    ignoreHidden:false,
                    ajaxPost:true,
                    datatype: ht.util.validformParam.datatype,
                    beforeCheck:function(curform){
                    },
                    beforeSubmit:function(curform){

                    },
                    ajaxpost:{
                        error:function(data,obj){
                        }
                    },
                    callback:function(data){
                        if(data.status=="y"){
                            $.Hidemsg();
                            var addressdetail=$('#province').val()+$('#city').val()+$('#area').val()+$('#address').val();
                            var resultAdd = [
                                {
                                    name:$('#name').val(),
                                    addressdetail:addressdetail,
                                    phone:$('#phone').val(),
                                    addressid:data.info
                                }
                            ];

                            $('#modAddress .oAddress tbody').append($('#templateoAddress').tmpl(resultAdd));
                            $('#newAddress').hide();
                        }
                    }
                });
            }
        }
    }
    $(function(){
        ht.commt.init();
    });
})(window);

