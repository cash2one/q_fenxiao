;;ht.search={
    init:function(){
        this.dis();
        this.hisGoods.init();
        this.progress();
        this.bindEvent();
    },
    sortArr:['人气','销量','价格'],
    hasQuestion:function(){
        var strAsk='';
        var local=window.location.href;
        if (local.indexOf('?')==-1){
            strAsk='?';
        }
        return strAsk;
    },
    bindEvent:function(){
        function replaceDesc(local,is_desc,index){
            if(!is_desc){
                if(index==2){
                    local=local+'&is_desc=asc';
                }else{
                    local=local+'&is_desc=desc';
                }

            }else{
                var strDesc=is_desc=='desc'?'asc':'desc';
                local=local.replace('&is_desc='+is_desc,'&is_desc='+strDesc);
                local=local.replace(/sortfield=(\S*)&/,'sortfield='+index+'&');
            }
            return local;
        }

        $('#sortparam').on('click','.jtag',function(){
            var local=window.location.href;
            local=local+ht.search.hasQuestion();
            var $this=$(this);
            var index=$this.index('.jtag');
            var sortfield=ht.util.getQuery('sortfield');
            var is_desc=ht.util.getQuery('is_desc');
            if(!sortfield){
                local=local+'&sortfield='+index;
            }else{
                local=local.replace('&sortfield='+sortfield,'&sortfield='+index);
            }
            //local=changeURLParam(local,is_desc,index);
            local=replaceDesc(local,is_desc,index);
            local=local.replace('?&','?');

            window.location.href=local;
        });
        $('#queryparam').on('click','.jtag',function(){

        });

    },
    progress:function(){
        $('#progress .progress-bar').css({'width':'100%'});
        setTimeout(function(){
            $('#progress').hide();
        },1500);
    },
    dis:function(){
        if( $('#brandsAllCtag').outerHeight()>$('#brandsAllCtagDad').height()){
            $('#moreBrand').show();
        }
        $('#moreBrand').toggle(function(){
            $('.hdbrands').removeClass('line2height').addClass('autoheight');
        },function(){
            $('.hdbrands').removeClass('autoheight').addClass('line2height');
        });
    },
    hisGoods:{
        init:function(){
            ht.util.lazyGet($('#pro_recBow'),function(){
                ht.search.hisGoods.get();
            });
        },

        get:function(){
            $('#pro_recBow').empty();
            $.getJSON('/item/history.html',function(r){
                $('#templateHisGoodsList').tmpl(r).appendTo('#pro_recBow');
            });
        }
    }
}
;$(function(){
    ht.search.init();
});
