(function(a,b){htRegister={init:function(){ht.util.placeholder();this.bindEvent()},validate:{chkPhone:function(){var c=false;var d=$("#phone");if(d.val()==""){d.parent().next(".error").html("请输入手机号码");d.parent().removeClass("err_label").addClass("err_label")}else{if(!/^1\d{10}$/.test(d.val())){d.parent().next(".error").html("手机号码格式不正确");d.parent().removeClass("err_label").addClass("err_label")}else{d.parent().next(".error").html("");d.parent().removeClass("err_label");c=true}}return c},chkKapkey:function(){var c=false;var d=$("#kapkey");if(d.val()==""){d.parent().parent().next(".error").html("请输入验证码");d.parent().removeClass("err_label").addClass("err_label")}else{if(d.val().length!=5){d.parent().parent().next(".error").html("验证码错误");d.parent().removeClass("err_label").addClass("err_label")}else{d.parent().parent().next(".error").html("");d.parent().removeClass("err_label");c=true}}return c},chkSmsCode:function(){var c=false;var d=$("#smskey");if(d.val()==""){d.parent().next(".error").html("请输入短信验证码");d.parent().removeClass("err_label").addClass("err_label")}else{if(d.val().length!=4){d.parent().next(".error").html("短信验证码错误");d.parent().removeClass("err_label").addClass("err_label")}else{d.parent().next(".error").html("");d.parent().removeClass("err_label");c=true}}return c},chkPassword:function(d){var c=false;if(d.val().length<6||d.val().length>18){d.parent().next(".error").html("请输入6-18位字符");d.parent().removeClass("err_label").addClass("err_label")}else{d.parent().next(".error").html("");d.parent().removeClass("err_label");c=true}return c}},bindEvent:function(){$("#imgKey").click(function(){$(this)[0].src="/common/image_code/?"+Math.random()});var c=$("#acceptFlyme");var g=$("#acceptError");$("#rememberField .mzchkbox").click(function(){if(c[0].checked){c[0].checked=false;$(".checkboxPic").removeClass("check_chk").addClass("check_unchk");g.show()}else{c[0].checked=true;$(".checkboxPic").removeClass("check_unchk").addClass("check_chk");g.hide()}});var f=$("#phone");var e=$("#kapkey");var d=$("#smskey");f.focus(function(){}).blur(function(){htRegister.validate.chkPhone()});e.focus(function(){}).blur(function(){htRegister.validate.chkKapkey()}).keyup(function(h){if(h.keyCode==13){$("#register").click()}});d.blur(function(){htRegister.validate.chkSmsCode()}).keyup(function(h){if(h.keyCode==13){$("#next").click()}});$("#register").click(function(){$("#spanerr").html("");var i=htRegister.validate.chkPhone();var h=htRegister.validate.chkKapkey();if(i&&h){if(!c[0].checked){return false}var j=$("input[name=_xsrf]").val();var k={phone:f.val(),code:e.val(),_xsrf:j};$.post("/reg.html",k,function(m){var m=JSON.parse(m);if(m.state!=200){$("#spanerr").html(m.info);return false}$("#step2_txt").html(m.info);$(".step1").hide();$(".step2").show();var l=60;$("#getKey").html("重新获取("+l+")").attr("v",l).addClass("btn_enabled");ht.util.setCountDown($("#getKey"),"获取验证码")})}});$("#next").click(function(){var h=htRegister.validate.chkSmsCode();if(h){var i={phone:f.val(),phonecode:$("#smskey").val()};$.get("/reg.html",i,function(j){var j=JSON.parse(j);if(j.state!=200){$("#spansmskeyerr").html(j.info);return false}$(".step2").hide();$(".step3").show()})}});$("#getKey").click(function(){if($(this).hasClass("btn_enabled")){return false}var h={phone:f.val()};$.get("/common/phone/code/",h,function(){var i=60;$("#getKey").html("重新获取("+i+")").attr("v",i).addClass("btn_enabled");ht.util.setCountDown($("#getKey"),"获取验证码")})});$("#password1").blur(function(){htRegister.validate.chkPassword($(this))});$("#password2").blur(function(){htRegister.validate.chkPassword($(this))}).keyup(function(h){if(h.keyCode==13){$("#regSubmit").click()}});$("#regSubmit").click(function(){var i=htRegister.validate.chkPassword($("#password1"));var k=htRegister.validate.chkPassword($("#password2"));if(i&&k){if($("#password1").val()!=$("#password2").val()){$("#password2").parent().next(".error").html("两次密码输入不一致");$("#password2").parent().removeClass("err_label").addClass("err_label")}else{var h=$("input[name=_xsrf]").val();var j={phone:f.val(),pwd:$("#password1").val(),smskey:$("#smskey").val(),option:"reg",_xsrf:h};$.post("/reg.html",j,function(l){var l=JSON.parse(l);if(l.state!=200){$("#pwderr").html(l.info);return false}else{a.location="/"}})}}})}};$(function(){htRegister.init()})})(window);